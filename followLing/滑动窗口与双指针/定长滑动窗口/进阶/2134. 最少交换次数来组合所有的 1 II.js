/**
 * 交换 定义为选中一个数组中的两个 互不相同 的位置并交换二者的值。

环形 数组是一个数组，可以认为 第一个 元素和 最后一个 元素 相邻 。

给你一个 二进制环形 数组 nums ，返回在 任意位置 将数组中的所有 1 聚集在一起需要的最少交换次数。

 

示例 1：

输入：nums = [0,1,0,1,1,0,0]
输出：1
解释：这里列出一些能够将所有 1 聚集在一起的方案：
[0,0,1,1,1,0,0] 交换 1 次。
[0,1,1,1,0,0,0] 交换 1 次。
[1,1,0,0,0,0,1] 交换 2 次（利用数组的环形特性）。
无法在交换 0 次的情况下将数组中的所有 1 聚集在一起。
因此，需要的最少交换次数为 1 。
示例 2：

输入：nums = [0,1,1,1,0,0,1,1,0]
输出：2
解释：这里列出一些能够将所有 1 聚集在一起的方案：
[1,1,1,0,0,0,0,1,1] 交换 2 次（利用数组的环形特性）。
[1,1,1,1,1,0,0,0,0] 交换 2 次。
无法在交换 0 次或 1 次的情况下将数组中的所有 1 聚集在一起。
因此，需要的最少交换次数为 2 。
示例 3：

输入：nums = [1,1,0,0,1]
输出：0
解释：得益于数组的环形特性，所有的 1 已经聚集在一起。
因此，需要的最少交换次数为 0 。
 */

/**
 * 解题思路：
 * 1. 首先计算数组中1的总数k，这就是我们需要聚集的1的数量，也是滑动窗口的大小
 * 2. 使用滑动窗口技术，在环形数组上滑动，窗口大小为k
 * 3. 对于每个窗口位置，计算窗口内1的数量
 * 4. 找到包含最多1的窗口，这样需要交换的次数最少（k - 窗口内1的最大数量）
 *
 * 时间复杂度：O(n)，其中n是数组的长度
 * 空间复杂度：O(1)
 */
const minSwaps = function (nums) {
  // 计算数组中1的总数，这就是窗口大小
  const k = nums.filter(item => item === 1).length
  
  // 如果没有1或者全是1，不需要交换
  if (k === 0 || k === nums.length) {
    return 0
  }
  
  // 初始化窗口，计算第一个窗口中1的数量
  let count = 0
  for (let i = 0; i < k; i++) {
    if (nums[i] === 1) {
      count++
    }
  }
  
  let max = count
  
  // 滑动窗口，遍历所有可能的窗口位置
  // 由于是环形数组，我们需要遍历n个位置
  for (let i = 1; i < nums.length; i++) {
    // 窗口移出位置的元素
    const outIndex = (i - 1) % nums.length
    // 窗口进入位置的元素
    const inIndex = (i + k - 1) % nums.length
    
    // 更新窗口中1的数量
    if (nums[outIndex] === 1) {
      count--
    }
    if (nums[inIndex] === 1) {
      count++
    }
    
    // 更新最大值
    max = Math.max(max, count)
  }

  // 最少交换次数 = 总1数量 - 窗口内1的最大数量
  // 因为窗口内已有的1不需要交换，只需要将窗口外的1交换进来
  return k - max
};
 
// 测试用例
const nums1 = [0, 1, 0, 1, 1, 0, 0]
console.log(`输入: [${nums1}]`)
console.log(`输出: ${minSwaps(nums1)}`) // 期望输出: 1

const nums2 = [0,1,1,1,0,0,1,1,0]
console.log(`\n输入: [${nums2}]`)
console.log(`输出: ${minSwaps(nums2)}`) // 期望输出: 2

const nums3 = [1,1,0,0,1]
console.log(`\n输入: [${nums3}]`)
console.log(`输出: ${minSwaps(nums3)}`) // 期望输出: 0

const nums4 = [0,0,0,0]
console.log(`\n输入: [${nums4}]`)
console.log(`输出: ${minSwaps(nums4)}`) // 期望输出: 0

const nums5 = [1,1,1,1]
console.log(`\n输入: [${nums5}]`)
console.log(`输出: ${minSwaps(nums5)}`) // 期望输出: 0